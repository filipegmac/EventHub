<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head th:replace="~{fragments/layout :: head('Notifica√ß√µes')}"></head>
<body>
    <header th:replace="~{fragments/layout :: header}"></header>
    
    <main class="main-content">
        <div class="container">
            <!-- Mensagens -->
            <div th:replace="~{fragments/layout :: messages}"></div>
            
            <!-- Header da p√°gina -->
            <div class="page-header">
                <h1>Notifica√ß√µes</h1>
                <form th:action="@{/notifications/read-all}" method="post" th:if="${!notifications.isEmpty()}">
                    <button type="submit" class="btn btn-secondary">Marcar todas como lidas</button>
                </form>
            </div>
            
            <!-- Lista de notifica√ß√µes -->
            <div class="notifications-list" th:if="${!notifications.isEmpty()}">
                <div th:each="notification : ${notifications}" 
                     class="notification-card"
                     th:classappend="${!notification.read} ? 'unread' : ''">
                    <div class="notification-icon">
                        <span th:if="${notification.invite and notification.pending}">üì©</span>
                        <span th:if="${notification.invite and notification.status == 'ACCEPTED'}">‚úÖ</span>
                        <span th:if="${notification.invite and notification.status == 'REJECTED'}">‚ùå</span>
                        <span th:if="${!notification.invite and !notification.read}">üîî</span>
                        <span th:if="${!notification.invite and notification.read}">‚úì</span>
                    </div>
                    <div class="notification-content">
                        <p class="notification-message" th:text="${notification.message}">Mensagem</p>
                        <span class="notification-date" 
                              th:text="${#temporals.format(notification.createdAt, 'dd/MM/yyyy HH:mm')}">
                            Data
                        </span>
                        <!-- Status do convite -->
                        <span class="notification-status" th:if="${notification.invite and notification.status == 'ACCEPTED'}">
                            ‚Äî Aceito
                        </span>
                        <span class="notification-status" th:if="${notification.invite and notification.status == 'REJECTED'}">
                            ‚Äî Recusado
                        </span>
                    </div>
                    <!-- Bot√µes de a√ß√£o para convites pendentes -->
                    <div class="notification-actions" th:if="${notification.invite and notification.pending}">
                        <form th:action="@{/notifications/{id}/accept(id=${notification.id})}" method="post" style="display:inline;">
                            <button type="submit" class="btn btn-sm btn-primary">Aceitar</button>
                        </form>
                        <form th:action="@{/notifications/{id}/reject(id=${notification.id})}" method="post" style="display:inline;">
                            <button type="submit" class="btn btn-sm btn-danger">Recusar</button>
                        </form>
                    </div>
                </div>
            </div>
            
            <!-- Estado vazio -->
            <div class="empty-state" th:if="${notifications.isEmpty()}">
                <div class="empty-content">
                    <span class="empty-icon">üîî</span>
                    <h3>Nenhuma notifica√ß√£o</h3>
                    <p>Voc√™ n√£o possui notifica√ß√µes no momento.</p>
                </div>
            </div>
        </div>
    </main>
    
    <footer th:replace="~{fragments/layout :: footer}"></footer>
</body>
</html>
